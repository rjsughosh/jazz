<!-- 404 / no data error message changed for env -->
<div class='feedback-overlay' *ngIf="openModal">
    <div class='feedback-wrap relative'>
        <div class='feedback-hdr relative'>Report an issue</div>
        <div class="separator-row"></div>
        <div class="loading-row" [class.show]="isLoading">
            <div class="loading-circle"></div>
        </div>
            <div class='feedback-text-wrap' [class.invisible]="isLoading || feedbackRes">
                <p>Found a problem with the site? Please use the form below to describe the issue and we will fix it soon.</p>
                <textarea rows="5" cols="50" type="text" name='userFeedback' id="userFeedback" placeholder="Report your issue here" [(ngModel)]="model.userFeedback"  #userFeedback='ngModel'></textarea>
            </div>
            <div class="feedback-text-wrap feedbackRes" [class.show]="feedbackRes">
                <div class="hide feedbackResSuccess" [class.show]="feedbackResSuccess">
                    <div>{{feedbackMsg}}</div>
                </div>
                <div class="hide feedbackResErr" [class.show]="feedbackResErr"> Oops! {{feedbackMsg}}
                    <span> or <a (click)="mailTo()"> contact us</a> via email.</span>
                </div>
            </div>
            <div class='feedback-btn-wrap'>
                <!-- <div class="includeError">
                    <input type="checkbox">
                    <span></span>
                </div> -->
                <div class="slack-checkbox custom-cb includeError" [class.invisible]="isLoading || feedbackRes">
                        <input type="checkbox" (click)="errorIncluded()"  id="checkbox-slack" [checked]="errorInclude">
                        <label for="checkbox-slack"></label>
                        <div class="cb-status-dets">Include error details</div>
                    </div>
                <a (click)='openModal = !openModal;isLoading=false'  [class.invisible]="isLoading || feedbackRes">CANCEL</a>
                <btn-tmobile-primary text="{{buttonText}}" class="feedback-submit" [class.invisible]="isLoading" [disablePrimaryBtn]="!model.userFeedback && buttonText=='SUBMIT'" (click)='submitFeedback(buttonText)'></btn-tmobile-primary>
            </div> 
    </div>    
</div>


<!-- <span  class="reduxC" *ngIf='service.status == "deletion completed"'></span>
<span  class="reduxS" *ngIf='service.status == "deletion started"'></span> -->
 <!-- <span  class="redux" *ngIf='true'></span> -->
<!-- <div class='current-status-wrap' *ngIf= " service.status === 'creation started' && service_error " > -->
    <div class='current-status-wrap' *ngIf= "creating && service_error ">
            <!-- <div class='current-status-wrap' *ngIf= "false"> -->
        
                        <div class="current-meter-status saving"><b>Current Status:</b> {{statusInfo}}<span> .</span><span> .</span><span> .</span></div>
            <div class="current-meter-bar">
                <span id='current-status-val' [ngClass]="statusCompleted || serviceStatusCompleted ? 'completed-bar':'under-progress-bar'" [class.deletion-bar]='statusFailed'></span>
        
                <div class='status-result'  [ngClass]="serviceStatusStarted ? 'under-progress-bar':'under-progress'" [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed' >
                    <div class='status-icon icon-icon-confirmcheck' *ngIf=' serviceStatusStarted '></div>
                    <div class='status-icon icon-icon-close' *ngIf=' serviceStatusStartedD '></div>
                    <div class='status-lable'>Started</div>
                </div>
                <div class='status-result' [ngClass]="serviceStatusValidate ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                    <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusValidate'></div>
                    <div class='status-icon icon-icon-close' *ngIf=' serviceStatusValidateD '></div>
                    <div class='status-lable'>Validation</div>
                </div>
                <div class='status-result' [ngClass]="serviceStatusRepo ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                    <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusRepo'></div>
                    <div class='status-icon icon-icon-close' *ngIf=' serviceStatusRepoD '></div>
                    <div class='status-lable repoCreation'>Repository Creation</div>
                </div>
                <div class='status-result' [ngClass]="serviceStatusPermission ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                    <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusPermission'></div>
                    <div class='status-icon icon-icon-close' *ngIf=' serviceStatusPermissionD '></div>
                    <div class='status-lable'>Permissions</div>
                </div>
                <div class='status-result' [ngClass]="serviceStatusCompleted ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                    <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusCompleted'></div>
                    <div class='status-icon icon-icon-close' *ngIf=' serviceStatusCompletedD '></div>
                    <div class='status-lable'>Completed</div>
                </div>
                
            </div>
           
        </div>
        
        
        <!-- <div class='current-status-wrap' *ngIf= " service.status === 'creation started' && service_error " > -->
        <div class='current-status-wrap' *ngIf= "deleting && service_error " >
                <!-- <div class='current-status-wrap' *ngIf= "true" > -->
            
            <div class="current-meter-status saving"><b>Current Status:</b> {{DelstatusInfo}}<span> .</span><span> .</span><span> .</span></div>
                <div class="current-meter-bar">
                    <span id='current-status-val' [ngClass]="statusCompleted || serviceStatusCompleted ? 'completed-bar':'under-progress-bar'" [class.deletion-bar]='statusFailed'></span>
            
                    <div class='status-result-delete'  [ngClass]="serviceStatusStarted ? 'under-progress-bar':'under-progress'" [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed' >
                        <div class='status-icon icon-icon-confirmcheck' *ngIf=' serviceStatusStarted '></div>
                        <div class='status-icon icon-icon-close' *ngIf=' serviceStatusStartedD '></div>
                        <div class='status-lable'>Deletion Started</div>
                    </div>
                    
                    <div class='status-result-delete' [ngClass]="serviceStatusValidate ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                        <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusValidate'></div>
                        <div class='status-icon icon-icon-close' *ngIf=' serviceStatusValidateD '></div>
                        <div class='status-lable'>Deleted Assets</div>
                    </div>
                    <div class='status-result-delete' [ngClass]="serviceStatusRepo ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                        <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusRepo'></div>
                        <div class='status-icon icon-icon-close' *ngIf=' serviceStatusRepoD '></div>
                        <div class='status-lable repoCreation'>Backed Up Project</div>
                    </div>
                    <!-- <div class='status-result' [ngClass]="serviceStatusPermission ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                        <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusPermission'></div>
                        <div class='status-icon icon-icon-close' *ngIf=' serviceStatusPermissionD '></div>
                        <div class='status-lable'>STEP 3</div>
                    </div> -->
        
                    <div class='status-result-delete' [ngClass]="serviceStatusCompleted ? 'under-progress-bar':'under-progress'"  [class.completed-bar]='statusCompleted' [class.deletion-status]='statusFailed'>
                        <div class='status-icon icon-icon-confirmcheck'  *ngIf='serviceStatusCompleted'></div>
                        <div class='status-icon icon-icon-close' *ngIf=' serviceStatusCompletedD '></div>
                        <div class='status-lable'>Deletion Completed</div>
                    </div>
                    
                </div>
            </div>
        
<!-- <div class='service-details row bottom-10' *ngIf='service.endpoints != undefined && (service.serviceType=="website" || service.serviceType=="api")'>
    <ul class=" col-md-12 col-sm-12">
        <li class='det-wrp' *ngIf='service.endpoints.dev != undefined'>
            <div class=' det-label align-slf'>Dev Endpoint</div>
            <div class='det-value endpoint-url align-slf'>
            
                <span>{{service.endpoints.dev}}</span>
            </div>
            <div class='det-value align-slf'>
                    <btn-tmobile-secondary class='testApiBtn' text='Test Dev Api' (click)='testApi("api","dev")' *ngIf='service.serviceType=="api"'></btn-tmobile-secondary>
                    <btn-tmobile-secondary class='testApiBtn' text='Go to Website' (click)='testApi("website","dev")'  *ngIf='service.serviceType=="website"'></btn-tmobile-secondary>
            </div>

        </li>
        <li class='det-wrp det-wrp-bottom' *ngIf='service.endpoints.prod != undefined'>
            <div class=' det-label align-slf'>Prod Endpoint</div>
            <div class='det-value endpoint-url align-slf'>
            
                <span>{{service.endpoints.prod}}</span>
            </div>
            <div class='det-value align-slf'>
                    <btn-tmobile-secondary class='testApiBtn' text='Test Prod Api' (click)='testApi("api","prod")' *ngIf='service.serviceType=="api"'></btn-tmobile-secondary>
                    <btn-tmobile-secondary class='testApiBtn' text='Go to Website' (click)='testApi("website","prod")'  *ngIf='service.serviceType=="website"'></btn-tmobile-secondary>
            </div>
        </li>
    </ul>
     <div class='api-btn-wrp'>
            
    </div>
</div> -->
<div class="service-details row">
    <!-- <span *ngIf='service.status=="deletion completed"'> -->
            <!-- <img id="robot" src="./../../../assets/erser/robot.jpg" /> -->
            <!-- <img class='redux' id="redux" src="./../../../assets/erser/overlay.svg" ng-mousedown="erase()" />
           
        </span> -->
<div class='edit-service-overview-btn'>
  <!-- Commented for production push - Sprint close #18 -->
  <!-- <btn-tmobile-secondary class='btn-edit-overview' *ngIf='showCancel'  text='CANCEL' (click)='onCancelClick()' ></btn-tmobile-secondary> -->
  <a  *ngIf='showCancel' (click)='onCancelClick()'>CANCEL</a>
  <btn-tmobile-secondary class='btn-edit-overview'  text='{{edit_save}}'  [class.diabledbtn]="service.status === 'creation started'" [ngClass]="service.status === 'creation started' ? 'non-clickable':''" (click)='onEditClick()' [disablebtn]='disableSaveBtn() || service.status == "creation started"'></btn-tmobile-secondary>
  <!-- [style.borders]="edit_save=='SAVE'? 'none':'1px solid'"  -->
</div><br>
<div class='show-service-overview' [class.hide]="disp_show">
<ul class="section-left col-md-6 col-sm-12">
    <li>
        <div class="det-label">Status</div>
        <div class="det-value">{{service.status}}</div>
     </li>
    <li>
        <div class="det-label">Description</div>
        <div class="det-value wrap" [ngClass]="{PlaceHolder:description_empty}">{{service.description || 'Give me the details for your service'}}</div>
    </li>
    <li>
        <div class="det-label decap">Approver(s)</div>
        <div class="det-value" [ngClass]="{PlaceHolder:approvers_empty}"  >{{service.approvers || 'NA'}}</div>
    </li>

    <li>
        <div class="det-label">Namespace</div>
        <div class="det-value">{{service.domain || 'Link a domain'}}</div>
    </li>
    <li>
        <div class="det-label">Service Type</div>
        <div class="det-value service-type">{{service.serviceType || 'Pick your service type'}}</div>

    </li>
</ul>
<ul class="section-right col-md-6 col-sm-12">
    <li>
        <div class="det-label">Email</div>
        <div class="det-value" [class.link]='!email_empty' [ngClass]="{PlaceHolder:email_empty}" >{{service.email || 'Stay connected with an email'}}</div>
    </li>
    <li>
        <div class="det-label">Slack Channel</div>
        <div class="det-value" [class.link]='!slackChannel_empty' [ngClass]="{PlaceHolder:slackChannel_empty}"  (click)="slack_link()">{{service.slackChannel || 'Feeling collaborative? Add it to slack'}}</div>
    </li>
    <li>
        <div class="det-label">Repository</div>
        <div class="det-value repository-link" [ngClass]="{'link':islink, 'PlaceHolder':repository_empty}" (click)="openLink(repositorylink)">{{bitbucketRepo || 'Stay organized with a repository'}}</div>
    </li>
    <li *ngIf="service.serviceType != 'website' ">
        <div class="det-label">Runtime</div>
        <div class="det-value" [class.PlaceHolder]="runtime_empty" >{{service.runtime}}</div>
    </li>
    <li>
        <div class="det-label">Tags</div>
        <div class="det-value" [ngClass]="{PlaceHolder:tags_empty}" >{{service.tags || 'Services are cooler with tags'}}</div>
    </li>
</ul>
</div>
<div class='edit-service-overview' [class.hide]="disp_edit">
        <ul class="section-left col-md-6 col-sm-12">

            <li>
                <div class="det-label">Status</div>
                <div class="det-value">{{service.status}}</div>
            </li>
            <li>
                    <div class="det-label">Description</div>
                    <textarea [(ngModel)]="desc_temp" (ngModelChange)='update_payload.description=desc_temp' class="det-value-input-txtarea" placeholder="Give me the details for your service"></textarea>
                </li>
                <li>
                    <div class="det-label decap">Approver(s)</div>
                    <div class="det-value">{{service.approvers || 'NA'}}</div>
                </li>

                <li>
                    <div class="det-label">Namespace</div>
                    <div class="det-value">{{service.domain || 'Link a domain'}}</div>
                </li>
                <li>
                    <div class="det-label">Service Type</div>
                    <div class="det-value service-type">{{service.serviceType || 'Pick your service type'}}</div>

                </li>
            </ul>
            <ul class="section-right col-md-6 col-sm-12">
                <li>
                    <div class="det-label">Email</div>
                    <input [(ngModel)]="email_temp" type='text' class="det-value-input" placeholder="Stay connected with an email" (ngModelChange)='update_payload.email=email_temp' (blur)="check_email_valid()">

                </li>
                <p class='email-err-msg' [class.hide]="hide_email_error">Please enter a valid email Id</p>
                <li class='relative'>
                    <div class="det-label">Slack Channel</div>
                    <input [(ngModel)]="slackChannel_temp" type='text' (blur)="checkSlackNameAvailability()" (ngModelChange)='update_payload.slack_channel=slackChannel_temp' class="det-value-input" placeholder="Feeling collaborative? Add it to slack">
                    <img *ngIf='show_loader' class="input-loader" src="../assets/images/icons/loading.png">
                </li>
                <p class='email-err-msg' [class.hide]='hide_slack_error'>Slack channel is not available. Please provide a valid slack channel.</p>
                <li>
                    <div class="det-label">Repository</div>
                    <div class="det-value link repository-link" (click)="openLink(service.repository)" placeholder="Stay organized with a repository">{{bitbucketRepo}}</div>
                </li>
                <li>
                    <div class="det-label">Runtime</div>
                    <div class="det-value">{{service.runtime}}</div>

                </li>
                <li>
                    <div class="det-label">Tags</div>
                    <input [(ngModel)]="tags_temp" (ngModelChange)='updateTags()' type='text' (focus)='flag=true;' (blur)='flag=false;' class="det-value-input" placeholder="Services are cooler with tags">
                </li>
                <p class='email-err-msg labelfortags' *ngIf='flag' >Please enter tags seperated by commas</p>
            </ul>
</div>
<div class="loading-row" [class.show]="isLoadingService">
    <div class="loading-circle"></div>
</div>
</div>
<div class="separator-row"></div>
<!--  
<div class="loading-row" [class.show]="isenvLoading">
    <div class="loading-circle"></div>
</div> -->

<div class="env-err-widget" >
    <div class="loading-row" [class.show]="isenvLoading">
        <div class="loading-circle"></div>
    </div> 
    <div class='ErrEnv' [class.show]="ErrEnv && !err404">
        <div class="icon-icon-server-error">
            <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span>
        </div>
        <div class='oops'>Oops!</div>
        <div>{{errMessage}}<br><a (click)="getenvData($event)">REFRESH</a> to give it another try.</div>
        <br><div class='ctc-us'>If the problem persists, <a (click)='reportIssue()'> contact us</a>.</div> 
    </div>
    <div class='ErrEnv'  [class.show]="ErrEnv && err404">
        <div class="empty-row nodata with-refresh relative">
            <div class="icon-icon-nodata"></div>
            <div class='hang-in'>
                <b>Oops, looks like there are no environments yet...</b>
                <p>
                    Please check again after some time.
                </p>
            </div>
        </div>
    </div>
    

</div>

<div *ngIf="!ErrEnv && !isenvLoading " class="service-overview-wrp relative">
    <div *ngIf='noProd' class='empty-row stg-wrp active'>No Data <br> Available</div>
    <div *ngIf='!noProd' class="stage-wrp active" (click)="stageClicked(prodEnv.logical_id)">    
        <div class="stage-title stageDisp">{{prodEnv.logical_id}} 
            <span class='icon-icon-rightArrow right-arow'></span>        
        </div>
        <div class="stage-overview">
            <ul class="service-overview">
                <li class="overview-item">
                    <div class="overview-value" [ngSwitch]="prodEnv.status" >
                        <!-- <div class='background-icon' [class.success]='prodEnv.status=="deployment completed"' [class.inprogress]='prodEnv.status=="deployment failed"' [class.failed]='prodEnv.status=="deployment started" || prodEnv.status=="active"'> -->
                            <span class='icon-icon-good' title='{{prodEnv.status}}' *ngSwitchCase='"deployment completed"'>
                                            
                                <span class="path1"></span><span class="path2"></span>
                                        
                        </span>
                        <span class='icon-icon-good' title='{{prodEnv.status}}' *ngSwitchCase='"active"'>
                                
                                <span class="path1"></span><span class="path2"></span>
                                        
                        </span>
                        
                        <span title='{{prodEnv.status}} '*ngSwitchCase='"deployment failed"' class='icon-icon-inactive' >
                                <span class="path1"></span><span class="path2"></span>
                        </span>
                        <span title='{{prodEnv.status}}' class='icon-icon-inactive' *ngSwitchDefault ></span>
                        <span title='{{prodEnv.status}}' class='icon-In-Progress' *ngSwitchCase='"deployment started"'></span>

                        <!-- </div> -->
                    </div>
                    <div class="overview-label">Deployment<br>Status</div>
                </li>
                <li class="overview-item">
                    <div class="overview-value">
                         NA
                    </div>
                    <div class="overview-label">Last Successful<br>Deployment</div>
                </li>           
               
               
                <li class="overview-item">
                    <div class="overview-value">{{prodEnv.deploymentsCountvalue || 'NA'}}</div>
                    <div class="overview-label">
                        <div># of Deployments<br>(Last 24 hours) </div>
                        <!-- <div>(Last 24 hours)</div> -->
                        <!-- ({{prodEnv.deploymentsCountduration}}) -->
                    </div>
                </li>
                <li class="overview-item" >
                    <div class="overview-value">{{prodEnv.costvalue || 'NA'}}</div>
                    <div class="overview-label">
                        <div>Cost<br>(Per Day) </div>
                        <!-- <div>(Per Day)</div> -->
                        <!-- {{prodEnv.costduration}} -->
                    </div>
                </li>
               
            </ul>
        </div>          
    </div>

    <div *ngIf='noStg && !isenvLoading' class='empty-row stage-wrp active'>No Data <br> Available</div>
    <div *ngIf='!noStg' class="stage-wrp active"  (click)="stageClicked(stgEnv.logical_id)">        
        <div class="stage-title stageDisp">{{stgEnv.logical_id}} 
            <span class='icon-icon-rightArrow right-arow'></span>        
        </div>
        <div class="stage-overview">
            <ul class="service-overview">
                <li class="overview-item">
                        <div class="overview-value" [ngSwitch]="stgEnv.status" >
                                <!-- <div class='background-icon' [class.success]='prodEnv.status=="deployment completed"' [class.inprogress]='prodEnv.status=="deployment failed"' [class.failed]='prodEnv.status=="deployment started" || prodEnv.status=="active"'> -->
                                    <span class='icon-icon-good' title='{{stgEnv.status}}' *ngSwitchCase='"deployment completed"'>
                                            
                                            <span class="path1"></span><span class="path2"></span>
                                                    
                                    </span>
                                    <span class='icon-icon-good' title='{{stgEnv.status}}' *ngSwitchCase='"active"'>
                                            
                                            <span class="path1"></span><span class="path2"></span>
                                                    
                                    </span>
                                    
                                    <span title='{{stgEnv.status}} '*ngSwitchCase='"deployment failed"' class='icon-icon-bad' >
                                            <span class="path1"></span><span class="path2"></span>
                                    </span>
                                    <span title='{{stgEnv.status}}' class='icon-icon-inactive' *ngSwitchDefault ></span>
                                    <span title='{{stgEnv.status}}' class='icon-In-Progress' *ngSwitchCase='"deployment started"'></span>
                
                            
                                <!-- </div> -->
                            </div>
                    <div class="overview-label">Deployment<br>Status</div>
                </li>
                <li class="overview-item dep">
                    <div class="overview-value">
                        <!-- <img *ngIf="stgEnv.serviceHealth == 'good'" src="assets/images/icons/icon-good.png">
                        <img *ngIf="stgEnv.serviceHealth == 'bad'" src="assets/images/icons/icon-bad.png"> -->
                        NA
                    </div>
                    <div class="overview-label">Last Successful<br>Deployment</div>
                </li>
                <li class="overview-item">
                    <div class="overview-value">{{stgEnv.deploymentsCountvalue || 'NA'}}</div>
                    <div class="overview-label">
                        <div># of Deployments<br>(Last 24 hours) </div>
                        <!-- <div>(Last 24 hours)</div> -->
                    </div>
                </li>
                <li class="overview-item" >
                    <div class="overview-value">{{stgEnv.costvalue || 'NA'}}</div>
                    <div class="overview-label">
                        <div>(Cost<br>Per Day) </div>
                        <!-- <div>(Per Day)</div> -->
                    </div>
                </li>
               
            </ul>
        </div> 
    </div>
           
</div>
        


<div *ngIf="!ErrEnv" class="service-overview-wrap relative row" >
    <div class='eachBranch col-md-2 col-sm-5' *ngFor='let item of Environments' (click)='stageClicked(item.logical_id)'>
        <div *ngIf='noSecEnv' class='empty-row'>No Environments Available</div>
        
        <div *ngIf='!noSecEnv'>   
            <div class='stage-title2 stageDisp'>{{item.logical_id}} <span class='icon-icon-rightArrow right-arow'></span> </div>
            <div class="overview-value"  [ngSwitch]="item.status">
                    <span class='icon-icon-good' title='{{item.status}}' *ngSwitchCase='"deployment completed"'>
                            
                            <span class="path1"></span><span class="path2"></span>
                                    
                    </span>
                    <span class='icon-icon-good' title='{{item.status}}' *ngSwitchCase='"active" '>
                            
                        <span class="path1"></span><span class="path2"></span>
                                
                    </span>
                    
                    <span title='{{item.status}}' *ngSwitchCase='"deployment failed"' class='icon-icon-bad' >
                            <span class="path1"></span><span class="path2"></span>
                    </span>
                    <span title='{{item.status}}' class='icon-icon-inactive' *ngSwitchDefault ></span>
                    <span title='{{item.status}}' class='icon-In-Progress' *ngSwitchCase='"deployment started"'></span>

            </div>
            <div class="overview-label">
                <span>Deployment<br>Status</span>
            </div>
            
            
        </div>
    </div>
</div>
